{% extends 'properties/base_dashboard.html' %}

{% block dashboard_content %}
<h3 class="mb-3">Mis Documentos — Propiedades Subidas por mí</h3>
<div class="card mb-4">
    <div class="card-body">
        {% for row in prop_rows %}
            <h5 class="mt-3">{{ row.property.code }} — {{ row.property.title|default:'(sin título)' }}</h5>
            {% if row.documents %}
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Título / Archivo</th>
                                <th>Subido</th>
                                <th>Aprobado</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for doc in row.documents %}
                            <tr>
                                <td>
                                    {% if doc.document_type %}
                                        {{ doc.document_type.name }}
                                    {% else %}
                                        —
                                    {% endif %}
                                </td>
                                <td>
                                    {% if doc.file and doc.file.url %}
                                        <a href="{{ doc.file.url }}" target="_blank">{{ doc.title|default:doc.file.name }}</a>
                                    {% else %}
                                        {{ doc.title|default:'(archivo no disponible)' }}
                                    {% endif %}
                                </td>
                                <td>{{ doc.uploaded_at|localtime|date:"Y-m-d H:i" }}</td>
                                <td>{% if doc.is_approved %}Si{% else %}No{% endif %}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p class="text-muted">No has subido documentos para esta propiedad.</p>
            {% endif %}
        {% empty %}
            <p>No tienes propiedades subidas por ti.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
